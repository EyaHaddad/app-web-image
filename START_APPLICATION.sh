#!/bin/bash
# Script de dÃ©marrage de l'application ImageFlow Pro avec la fonctionnalitÃ© Cropping

# Configuration
PROJECT_PATH="c:\Users\Administrator\Documents\Institut\ING-2\Traitement-Image\App_Web_Image"

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘     ImageFlow Pro - Application de Traitement d'Images              â•‘"
echo "â•‘         Avec nouvelle fonctionnalitÃ©: CROPPING                      â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# VÃ©rification du rÃ©pertoire
echo "[1/4] VÃ©rification du rÃ©pertoire..."
if [ ! -d "$PROJECT_PATH" ]; then
    echo "âŒ Le rÃ©pertoire n'existe pas: $PROJECT_PATH"
    exit 1
fi
echo "âœ… RÃ©pertoire trouvÃ©"
echo ""

# Navigation vers le rÃ©pertoire
echo "[2/4] Navigation vers le rÃ©pertoire du projet..."
cd "$PROJECT_PATH" || exit 1
echo "âœ… Dans le rÃ©pertoire: $(pwd)"
echo ""

# DÃ©marrage du backend
echo "[3/4] DÃ©marrage du backend (FastAPI)..."
echo "Commande: uv run uvicorn backend.app.main:app --reload"
echo "URL: http://localhost:8000"
echo "API Docs: http://localhost:8000/docs"
echo ""
echo "â³ Le backend dÃ©marre dans 5 secondes..."
sleep 2

# Note pour l'utilisateur
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘ INSTRUCTIONS POUR DÃ‰MARRER L'APPLICATION                           â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ–¥ï¸  TERMINAL 1 - BACKEND (FastAPI)"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "ExÃ©cutez cette commande:"
echo ""
echo "    cd \"c:\\Users\\Administrator\\Documents\\Institut\\ING-2\\Traitement-Image\\App_Web_Image\""
echo "    uv run uvicorn backend.app.main:app --reload"
echo ""
echo "Attendez que le message s'affiche:"
echo "    âœ… Uvicorn running on http://127.0.0.1:8000"
echo ""
echo "Vous pouvez accÃ©der Ã :"
echo "    â€¢ API Docs (Swagger): http://localhost:8000/docs"
echo "    â€¢ ReDoc: http://localhost:8000/redoc"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸŒ TERMINAL 2 - FRONTEND (Streamlit)"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "ExÃ©cutez cette commande:"
echo ""
echo "    cd \"c:\\Users\\Administrator\\Documents\\Institut\\ING-2\\Traitement-Image\\App_Web_Image\""
echo "    streamlit run frontend/app.py"
echo ""
echo "L'application s'ouvrira automatiquement Ã :"
echo "    http://localhost:8501"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“ UTILISER LA NOUVELLE FONCTIONNALITÃ‰ CROPPING"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "1. Charger une image via le bouton de tÃ©lÃ©chargement"
echo "2. Cliquer sur l'onglet \"âœ‚ï¸ Cropping\" (2e onglet)"
echo "3. Ajuster les paramÃ¨tres:"
echo "   â€¢ Sliders: Position X/Y, Largeur, Hauteur"
echo "   â€¢ PrÃ©sets: CarrÃ©, 16:9, 9:16, 4:3"
echo "4. PrÃ©visualiser le rÃ©sultat (avant/aprÃ¨s)"
echo "5. Cliquer \"âœ‚ï¸ Appliquer le Crop\""
echo "6. L'image est mise Ã  jour et prÃªte pour d'autres transformations"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ§ª TESTER L'API DIRECTEMENT"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Vous pouvez tester l'endpoint /crop Ã  partir de:"
echo ""
echo "1. Swagger UI (recommandÃ©):"
echo "   http://localhost:8000/docs"
echo "   â€¢ Trouver l'endpoint POST /crop"
echo "   â€¢ Cliquer \"Try it out\""
echo "   â€¢ Charger une image et dÃ©finir les paramÃ¨tres"
echo ""
echo "2. Via curl (en PowerShell):"
echo "   $form = @{"
echo "     'file' = Get-Item 'path/to/image.png'"
echo "     'x' = '100'"
echo "     'y' = '50'"
echo "     'width' = '400'"
echo "     'height' = '300'"
echo "   }"
echo "   Invoke-RestMethod -Uri 'http://localhost:8000/api/crop' \"
echo "     -Method Post -Form $form -OutFile 'result.png'"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“š DOCUMENTATION"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Consultez les fichiers suivants pour plus d'informations:"
echo ""
echo "1. RESUME_CROPPING.md"
echo "   â””â”€ RÃ©sumÃ© complet des implÃ©mentations"
echo ""
echo "2. CROP_FEATURE.md"
echo "   â””â”€ Documentation dÃ©taillÃ©e de la fonctionnalitÃ©"
echo ""
echo "3. TEST_CROPPING.md"
echo "   â””â”€ Guide de test avec exemples"
echo ""
echo "4. ARCHITECTURE_CROPPING.md"
echo "   â””â”€ Diagrammes d'architecture et flux de donnÃ©es"
echo ""
echo "5. EXEMPLE_VISUEL_CROPPING.md"
echo "   â””â”€ AperÃ§u visuel de l'interface"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "âš ï¸  DÃ‰PANNAGE"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "ProblÃ¨me: \"Impossible de se connecter au backend\""
echo "Solution: Assurez-vous que le backend (uvicorn) est dÃ©marrÃ© sur le port 8000"
echo ""
echo "ProblÃ¨me: \"Module not found\""
echo "Solution: Assurez-vous d'avoir exÃ©cutÃ© 'uv sync' et 'pip install -r requirements.txt'"
echo ""
echo "ProblÃ¨me: \"Address already in use\""
echo "Solution: Le port 8000 (ou 8501) est dÃ©jÃ  utilisÃ©."
echo "          Tuez le processus ou utilisez un port diffÃ©rent"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "âœ… PrÃªt? ExÃ©cutez les commandes dans deux terminaux diffÃ©rents!"
echo ""
